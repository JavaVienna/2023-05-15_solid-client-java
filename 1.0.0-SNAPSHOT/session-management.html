<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/apt/session-management.apt.vm at 2023-03-03
 | Rendered using Apache Maven Fluido Skin 1.11.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Inrupt Java Client Libraries &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.11.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.11.1.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>Inrupt Java Client Libraries</h1>
</div>
</div>
          <div class="pull-right"><a href="index.html" id="bannerRight"><img src="images/inrupt_logo-2020.svg"  alt="Inrupt" style="" /></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-03-03<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Inrupt Client</li>
    <li><a href="index.html" title="Home"><span class="none"></span>Home</a></li>
    <li><a href="getting-started.html" title="Getting Started"><span class="none"></span>Getting Started</a></li>
    <li><a href="usage-examples.html" title="Usage Examples"><span class="none"></span>Usage Examples</a></li>
    <li class="active"><a><span class="none"></span>Session Management</a></li>
    <li><a href="data-modeling.html" title="Data Modeling"><span class="none"></span>Data Modeling</a></li>
    <li><a href="apidocs/" title="Documentation"><span class="none"></span>Documentation</a></li>
    <li><a href="licenses.html" title="License"><span class="none"></span>License</a></li>
    <li><a href="modules.html" title="Modules"><span class="none"></span>Modules</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="Session_Management"></a>Session Management</h2>
<p>All authentication and authorization in the Inrupt Java Client Libraries occur in the context of a <code>Session</code> object. By default, all client interactions use an anonymous session. For any interaction with non-public resources, you will need a mechanism for authenticating users. This guide will help you determine how best to create and manage these sessions in your Solid application.</p><section>
<h3><a name="What_you_will_need"></a>What you will need</h3>
<ul>
<li>About 15 minutes</li>
<li>Your favorite text editor or IDE</li>
<li>Java 11 or later</li>
<li>Maven 3.5 or later</li></ul></section><section>
<h3><a name="How_to_complete"></a>How to complete</h3>
<p>The first step is to consider how users will interact with your application.</p>
<ul>
<li>Will this application run as a Web Application with many different users logging in? If so, follow the steps for <a href="#Web_Applications">Web Applications</a>.</li>
<li>Will this application run from the Command Line with a single user? If so, follow the steps for <a href="#Command_Line_Applications">Command Line Applications</a>.</li></ul>
<p>There are other, more advanced options possible, but these will be the two most common patterns. Furthermore, both patterns also support the use of Access Grants, which is described in the <a href="#Using_Access_Grants">Using Access Grants</a> section.</p>
<p>After deciding how to establish a <code>Session</code>, you will pass that value to your client to create a Session-constrained client, as described in <a href="#Using_Session_objects_with_a_Client">Using Session objects with a Client</a>.</p>
<p>If you are using Solid <a href="#Access_Grants">Access Grants</a>, please refer to that section for more information.</p>
<p>Finally, you can move on to the <a href="./data-modeling.html">data modeling</a> section, which describes how to bind Java objects to RDF resources.</p></section><section>
<h3><a name="Web_Applications"></a>Web Applications</h3>
<p>A very common pattern for building Solid apps involves operating them as Web Applications in which different users are able to login with a Web Browser.</p>
<p>Most Java-based Web Applications will use a framework, such as <a class="externalLink" href="https://spring.io/">Spring Boot</a>, <a class="externalLink" href="https://quarkus.io/">Quarkus</a> or <a class="externalLink" href="https://micronaut.io/">Micronaut</a>. Each of these frameworks already provides an OpenID Connect Authentication integration. These frameworks will expect a <code>client_id</code> value and the URL of an authorization server. There will typically be other configuration properties, but this guide focuses on these two values.</p>
<p>If you are using Inrupt's Open ID Provider, the authorization server URL will be <code>https://login.inrupt.com</code>.</p>
<p>For the <code>client_id</code>, you will use a &quot;public client&quot;, which does not need authentication. For this, you can either create your own &quot;<a class="externalLink" href="https://solidproject.org/TR/oidc#clientids-document">Client Identifier document</a>&quot;, and make this available in a public location on the Web. Ensure that the URL of this resource is exactly the same as the <code>client_id</code> property of the document. Below is an example of a Client Identifier document.</p>
<div class="source"><pre class="prettyprint">{
  &quot;@context&quot;: [
    &quot;https://www.w3.org/ns/solid/oidc-context.jsonld&quot;
  ],
  &quot;client_id&quot;: &quot;https://application.example/identifier.jsonld&quot;,
  &quot;client_name&quot;: &quot;My First Solid Application&quot;,
  &quot;client_uri&quot;: &quot;https://application.example/&quot;,
  &quot;redirect_uris&quot;: [
    &quot;https://application.example/callback&quot;
  ],
  &quot;post_logout_redirect_uris&quot;: [
    &quot;https://application.example/&quot;
  ]
}</pre></div>
<p>Alternatively, if you plan to run your application at <code>http://localhost:8080/</code> you can use a special Client Id for testing at <code>https://inrupt.github.io/solid-client-java/clients/testing.jsonld</code>.</p>
<p>For this example, assume that your application will run at the URL <code>https://application.example/</code> (and for development at <code>http://localhost:8080/</code>)</p>
<p>Using the <a class="externalLink" href="https://openid.net/connect/">OpenID Connect</a> extension for the relevant framework, it will be possible to get a raw ID Token. This is all that is needed by the Inrupt Java Client. In particular, the <code>com.inrupt.client.openid.OpenIdSession.ofIdToken(String)</code> method will be used in this scenario.</p>
<p>For example, with Quarkus, your code might look like this:</p>
<div class="source"><pre class="prettyprint">@ApplicationScoped
public class MyEndpoint {

    @Inject
    @IdToken
    JsonWebToken idToken;

    @GET
    @Path(&quot;/&quot;)
    public MyDataResource fetch() {
        Session session = OpenIdSession.ofIdToken(idToken.getRawToken());
        ...
    }
}</pre></div>
<p>With Spring Boot, your code might look like this:</p>
<div class="source"><pre class="prettyprint">@RestController
public class Endpoint {

    @GetMapping(&quot;/&quot;)
    public MyDataResource fetch(@AuthenticationPrincipal OidcUser principal) {
        Session session = OpenIdSession.ofIdToken(principal.getIdToken().getTokenValue());
        ...
    }

}</pre></div>
<p>In both cases, a <code>Session</code> object is created by passing the value of the OpenID Connect ID Token to the <code>OpenIdSession::ofIdToken</code> method.</p></section><section>
<h3><a name="Command_Line_Applications"></a>Command Line Applications</h3>
<p>Command-line applications will typically operate on behalf of a single user. For this type of interaction, you will need to establish a &quot;client credential&quot; using a few pieces of information that are retrieved from an identity provider such as the Application Registration page on <a class="externalLink" href="https://login.inrupt.com/registration.html">Inrupt's OpenID Provider</a>. After logging in to the identity provider, you can register a new application and in turn, get:</p>
<ul>
<li><code>client_id</code></li>
<li><code>client_secret</code></li></ul>
<p>In addition, you will need an <code>issuer</code> value, which in this case is <code>https://login.inrupt.com</code> and an <code>authentication_method</code>, which will be <code>client_secret_basic</code>.</p>
<p>Building a session with this information will make use of the <code>OpenIdSession.ofClientCredentials()</code> method as in the following example.</p>
<div class="source"><pre class="prettyprint">public class MyApplication {

    public void run() {
        URI issuer = URI.create(&quot;https://login.inrupt.com&quot;);
        Session session = OpenIdSession.ofClientCredentials(issuer, &quot;&lt;your-client-id&gt;&quot;, &quot;&lt;your-client-secret&gt;&quot;, &quot;client_secret_basic&quot;);
        ...
    }
}</pre></div></section><section>
<h3><a name="Using_Session_objects_with_a_Client"></a>Using Session objects with a Client</h3>
<p>In order to create a Session-scoped client, use the <code>::session(Session)</code> method with the client of your choice.</p>
<p><b>Note</b>: all subsequent interactions should use the <i>returned</i> client value. Each client object is stateless: calling the <code>session(Session)</code> method will not change the original client.</p>
<div class="source"><pre class="prettyprint">public class MyApplication {

    SolidSyncClient client;

    void init() {
        Session session = ...;
        client = SolidSyncClient.getClient().session(session);
    }
}</pre></div></section><section>
<h3><a name="Access_Grants"></a>Access Grants</h3>
<p><a class="externalLink" href="https://docs.inrupt.com/ess/latest/security/access-requests-grants/">Access Grants</a> provide an alternative way to give access to your Solid resources. The Inrupt Java Client Libraries provide tooling for working with Access Grants.</p>
<p>Access Grant-based sessions are more complicated than OpenId-based sessions in that an Access Grant session <i>also</i> requires an OpenId session. This is best illustrated with an example:</p>
<div class="source"><pre class="prettyprint">public class MyApplication {

    SolidSyncClient client;

    void init() throws IOException {
        try (InputStream grant = MyApplication.class.getResourceAsStream(&quot;/access-grant.json&quot;)) {
            // Parse Access Grant
            AccessGrant accessGrant = AccessGrant.ofAccessGrant(grant);

            // Set up OpenId Session
            Session openid = OpenIdSession.ofClientCredentials(issuer, clientId, clientSecret, authMethod);

            // Set up Access Grant Session
            Session session = AccessGrantSession.ofAccessGrant(openid, accessGrant);

            client = SolidSyncClient.getClient().session(session);
        }
    }
}</pre></div>
<p>In this case, if you have an existing Access Grant, you can create a <code>Session</code> that uses an OpenID-based session with these Access Grants.</p></section><section>
<h3><a name="Next_Steps"></a>Next Steps</h3>
<p>If you are using one of the high-level clients and you have a working <code>Session</code> object, you can move on to the <a href="./data-modeling.html">data modeling</a> section, which describes how to bind Java objects to RDF resources.</p></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2023
<a href="https://inrupt.com">Inrupt, Inc</a>
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
